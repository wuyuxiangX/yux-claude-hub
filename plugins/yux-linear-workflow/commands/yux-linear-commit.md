# Linear Commit - é˜¶æ®µæ€§æäº¤

åœ¨å¼€å‘è¿‡ç¨‹ä¸­è¿›è¡Œé˜¶æ®µæ€§æäº¤ï¼Œå…³è” Linear issueï¼Œå¹¶åŒæ­¥è®°å½•åˆ° Linearã€‚

**Usage**: `/yux-linear-commit [description]`

## Input

å¯é€‰çš„æäº¤æè¿°ï¼ˆä»…ä½œä¸ºå‚è€ƒï¼Œä¸ç›´æ¥ä½¿ç”¨ï¼‰: $ARGUMENTS

## Workflow

### Step 1: æ£€æµ‹å½“å‰çŠ¶æ€

1. **è·å–å½“å‰åˆ†æ”¯**:
   ```bash
   git branch --show-current
   ```

2. **æå– Linear issue ID** (LIN-xxx pattern)
   - å¦‚æœä¸åœ¨ Linear åˆ†æ”¯ä¸Šï¼Œæç¤ºç”¨æˆ·å…ˆè¿è¡Œ `/yux-linear-start`

3. **è¯»å–æœ¬åœ°çŠ¶æ€æ–‡ä»¶**:
   - è·¯å¾„: `.claude/linear-tasks/<ISSUE_ID>.json`
   - è·å– issue_uuid ç”¨äºåç»­ Linear API è°ƒç”¨

4. **æ£€æŸ¥æœªæäº¤å˜æ›´**:
   ```bash
   git status --porcelain
   ```
   - å¦‚æœæ²¡æœ‰å˜æ›´ï¼Œæç¤º "æ²¡æœ‰éœ€è¦æäº¤çš„å˜æ›´" å¹¶ç»“æŸ

### Step 2: æ˜¾ç¤ºå˜æ›´æ–‡ä»¶åˆ—è¡¨

è¿è¡Œ `git status --porcelain` å¹¶åˆ†ç±»æ˜¾ç¤ºï¼š

**Chinese**:
```
=== å½“å‰å˜æ›´ ===

ğŸ“ æ–°å¢æ–‡ä»¶ (3):
   [1] src/components/Login.tsx
   [2] src/utils/auth.ts
   [3] tests/login.test.ts

ğŸ“ ä¿®æ”¹æ–‡ä»¶ (2):
   [4] src/App.tsx
   [5] package.json

ğŸ—‘ï¸ åˆ é™¤æ–‡ä»¶ (1):
   [6] src/old-login.js

âš ï¸ å»ºè®®å¿½ç•¥ (ä¸è®¡å…¥ç¼–å·):
   - .env.local (æ•æ„Ÿæ–‡ä»¶)
   - .DS_Store (ç³»ç»Ÿæ–‡ä»¶)
```

**English**:
```
=== Current Changes ===

ğŸ“ New files (3):
   [1] src/components/Login.tsx
   [2] src/utils/auth.ts
   [3] tests/login.test.ts

ğŸ“ Modified files (2):
   [4] src/App.tsx
   [5] package.json

ğŸ—‘ï¸ Deleted files (1):
   [6] src/old-login.js

âš ï¸ Suggested to ignore (not numbered):
   - .env.local (sensitive file)
   - .DS_Store (system file)
```

### Step 3: ç”¨æˆ·é€‰æ‹©æäº¤æ–‡ä»¶

ä½¿ç”¨ AskUserQuestion å·¥å…·è®©ç”¨æˆ·é€‰æ‹©ï¼š

**Chinese**:
```
è¯·é€‰æ‹©è¦æäº¤çš„æ–‡ä»¶ï¼š

1. æäº¤æ‰€æœ‰å˜æ›´ (6 ä¸ªæ–‡ä»¶)
2. é€‰æ‹©ç‰¹å®šæ–‡ä»¶ (è¾“å…¥ç¼–å·ï¼Œå¦‚: 1,2,4)
3. æ’é™¤ç‰¹å®šæ–‡ä»¶ (è¾“å…¥è¦æ’é™¤çš„ç¼–å·ï¼Œå¦‚: -5,-6)
4. å–æ¶ˆæäº¤
```

**English**:
```
Select files to commit:

1. Commit all changes (6 files)
2. Select specific files (enter numbers, e.g.: 1,2,4)
3. Exclude specific files (enter numbers to exclude, e.g.: -5,-6)
4. Cancel
```

### Step 3.5: åŸå­æ€§åˆ†æ (Atomic Check)

**åœ¨ç”Ÿæˆæäº¤ä¿¡æ¯å‰ï¼Œå…ˆåˆ†æå˜æ›´çš„åŸå­æ€§**ï¼š

1. **åˆ†æå˜æ›´å†…å®¹**:
   - è¯»å–é€‰ä¸­æ–‡ä»¶çš„ diff
   - åˆ¤æ–­å˜æ›´æ˜¯å¦åŒ…å«å¤šä¸ªä¸ç›¸å…³çš„æ”¹åŠ¨

2. **å¦‚æœå˜æ›´åŒ…å«å¤šä¸ªç‹¬ç«‹åŠŸèƒ½**ï¼Œå»ºè®®æ‹†åˆ†ï¼š

**Chinese**:
```
âš ï¸ å»ºè®®æ‹†åˆ†æäº¤

æ£€æµ‹åˆ°å˜æ›´åŒ…å«å¤šä¸ªç‹¬ç«‹åŠŸèƒ½ï¼š
1. UI å˜æ›´: src/components/Login.tsx, src/App.tsx
2. API å˜æ›´: src/api/auth.ts

å»ºè®®ï¼š
- ç¬¬ä¸€æ¬¡æäº¤: UI ç›¸å…³æ–‡ä»¶ (é€‰æ‹© 1,2)
- ç¬¬äºŒæ¬¡æäº¤: API ç›¸å…³æ–‡ä»¶ (é€‰æ‹© 3)

æ˜¯å¦æ‹†åˆ†æäº¤ï¼Ÿ(y/n ç»§ç»­å½“å‰é€‰æ‹©)
```

**English**:
```
âš ï¸ Suggest splitting commit

Detected multiple independent changes:
1. UI changes: src/components/Login.tsx, src/App.tsx
2. API changes: src/api/auth.ts

Suggestion:
- First commit: UI files (select 1,2)
- Second commit: API files (select 3)

Split commit? (y/n to continue with current selection)
```

3. **å¦‚æœå˜æ›´æ˜¯åŸå­çš„**ï¼Œæ˜¾ç¤ºç¡®è®¤å¹¶ç»§ç»­ï¼š
```
âœ“ åŸå­æ€§æ£€æŸ¥é€šè¿‡ (æ‰€æœ‰å˜æ›´å±äºåŒä¸€åŠŸèƒ½æ¨¡å—)
```

### Step 4: ç”Ÿæˆæäº¤ä¿¡æ¯

**Claude è‡ªåŠ¨ç”Ÿæˆæäº¤ä¿¡æ¯**ï¼ˆç”¨æˆ·è¾“å…¥ä»…ä½œä¸ºå‚è€ƒï¼‰ï¼š

1. **åˆ†æå˜æ›´å†…å®¹**:
   - è¯»å–é€‰ä¸­æ–‡ä»¶çš„ diff
   - åˆ¤æ–­å˜æ›´ç±»å‹å’Œå½±å“èŒƒå›´

2. **è‡ªåŠ¨å†³å®šæäº¤ä¿¡æ¯**:
   - `emoji`: æ ¹æ®ç±»å‹é€‰æ‹©è¡¨æƒ…ç¬¦å·
   - `type`: feat/fix/docs/refactor/test/chore/style/perf
   - `scope`: æ ¹æ®å˜æ›´æ–‡ä»¶æ¨æ–­æ¨¡å—ï¼ˆå¦‚ auth, ui, apiï¼‰
   - `subject`: **ä¸­æ–‡**æè¿°ï¼Œä¸è¶…è¿‡ 50 å­—ç¬¦

3. **Emoji æ˜ å°„è¡¨**:

| Type | Emoji | å«ä¹‰ |
|------|-------|------|
| feat | âœ¨ | æ–°åŠŸèƒ½ |
| fix | ğŸ› | ä¿®å¤ Bug |
| docs | ğŸ“ | æ–‡æ¡£ |
| style | ğŸ’„ | æ ¼å¼/æ ·å¼ |
| refactor | â™»ï¸ | é‡æ„ |
| perf | âš¡ï¸ | æ€§èƒ½ |
| test | âœ… | æµ‹è¯• |
| build | ğŸ“¦ | æ„å»º |
| ci | ğŸ‘· | CI/CD |
| chore | ğŸ”§ | æ‚é¡¹ |

4. **æ˜¾ç¤ºç”Ÿæˆçš„æäº¤ä¿¡æ¯**è®©ç”¨æˆ·ç¡®è®¤ï¼š

**Chinese**:
```
ç”Ÿæˆçš„æäº¤ä¿¡æ¯ï¼š

âœ¨ feat(auth): å¢åŠ ç™»å½•ç»„ä»¶å’Œè®¤è¯å·¥å…·

**What (åšäº†ä»€ä¹ˆ)**
- åœ¨ `src/components` ä¸­æ·»åŠ  LoginForm.tsx ç»„ä»¶
- æ·»åŠ  `auth.ts` è®¤è¯å·¥å…·ç±»
- æ›´æ–° App.tsx é›†æˆç™»å½•è·¯ç”±

**Why (ä¸ºä»€ä¹ˆåš)**
ä¸ºç”¨æˆ·æä¾›ç™»å½•å…¥å£ï¼Œå®ç°åŸºç¡€è®¤è¯æµç¨‹ã€‚

Refs: LIN-456

**Who (è°åšçš„)**
Co-Authored-By: wuyuxiang ğŸ¤– Generated by Claude AI

ç¡®è®¤ï¼Ÿ(y/ä¿®æ”¹å†…å®¹/nå–æ¶ˆ)
```

**English**:
```
Generated commit message:

âœ¨ feat(auth): å¢åŠ ç™»å½•ç»„ä»¶å’Œè®¤è¯å·¥å…·

**What (åšäº†ä»€ä¹ˆ)**
- Add LoginForm.tsx component in `src/components`
- Add `auth.ts` authentication utility
- Update App.tsx to integrate login route

**Why (ä¸ºä»€ä¹ˆåš)**
Provide login entry for users and implement basic authentication flow.

Refs: LIN-456

**Who (è°åšçš„)**
Co-Authored-By: wuyuxiang ğŸ¤– Generated by Claude AI

Confirm? (y/modify/n)
```

5. **å›ºå®šæ ¼å¼**:
   ```
   <emoji> <type>(<scope>): <subject (ä¸­æ–‡)>

   **What (åšäº†ä»€ä¹ˆ)**
   - å…·ä½“æ”¹åŠ¨ç‚¹ 1
   - å…·ä½“æ”¹åŠ¨ç‚¹ 2

   **Why (ä¸ºä»€ä¹ˆåš)**
   è§£é‡Šæ”¹åŠ¨åŠ¨æœº

   Refs: LIN-456

   **Who (è°åšçš„)**
   Co-Authored-By: wuyuxiang ğŸ¤– Generated by Claude AI
   ```

**é‡è¦è§„åˆ™**:
- Subject å¿…é¡»ä½¿ç”¨**ä¸­æ–‡**
- ä¸æ‰§è¡Œ `git push`ï¼Œåªæ‰§è¡Œ `git add` å’Œ `git commit`
- ç”¨æˆ·æ‰‹åŠ¨æ‰§è¡Œ `git push`

### Step 5: æ‰§è¡Œæäº¤

1. **æš‚å­˜é€‰ä¸­çš„æ–‡ä»¶**:
   ```bash
   git add <file1> <file2> ...
   ```

2. **åˆ›å»ºæäº¤**:
   ```bash
   git commit -m "<message>"
   ```

3. **æ˜¾ç¤ºæäº¤ç»“æœ**:

**Chinese**:
```
âœ“ å·²æäº¤ 4 ä¸ªæ–‡ä»¶

æäº¤å“ˆå¸Œ: abc1234
æäº¤ä¿¡æ¯: feat(auth): add login component
å…³è” Issue: LIN-456
```

**English**:
```
âœ“ Committed 4 files

Commit hash: abc1234
Message: feat(auth): add login component
Related Issue: LIN-456
```

### Step 6: åŒæ­¥åˆ° Linear (å¿…é¡»)

æäº¤æˆåŠŸåï¼Œ**å¿…é¡»**åœ¨ Linear issue ä¸Šæ·»åŠ è¯„è®ºè®°å½•ï¼š

```
mcp__linear__create_comment(
  issueId: "<issue-uuid>",
  body: "ğŸ“ **Commit**: `abc1234`\n\n```\nfeat(auth): add login component\n```\n\n**Files changed**: 4\n- src/components/Login.tsx\n- src/utils/auth.ts\n- ..."
)
```

æ˜¾ç¤ºåŒæ­¥ç»“æœï¼š

**Chinese**:
```
âœ“ å·²åŒæ­¥åˆ° Linear: LIN-456
```

**English**:
```
âœ“ Synced to Linear: LIN-456
```

### Step 7: è¾“å‡ºå®Œæˆæ‘˜è¦

**Chinese**:
```
=== æäº¤å®Œæˆ ===

æäº¤å“ˆå¸Œ: abc1234
æäº¤ä¿¡æ¯: feat(auth): add login component
æ–‡ä»¶æ•°é‡: 4
Linear:   LIN-456 âœ“

ä¸‹ä¸€æ­¥ï¼š
- ç»§ç»­å¼€å‘
- /yux-linear-commit å†æ¬¡æäº¤
- /yux-linear-pr åˆ›å»º PR
```

**English**:
```
=== Commit Complete ===

Commit hash: abc1234
Message: feat(auth): add login component
Files: 4
Linear: LIN-456 âœ“

Next steps:
- Continue development
- /yux-linear-commit to commit again
- /yux-linear-pr to create PR
```

## ç‰¹æ®Šæ–‡ä»¶å¤„ç†

### è‡ªåŠ¨å»ºè®®å¿½ç•¥çš„æ–‡ä»¶æ¨¡å¼

| æ¨¡å¼ | åŸå›  |
|------|------|
| `.env*` | æ•æ„Ÿé…ç½® |
| `*.local` | æœ¬åœ°é…ç½® |
| `node_modules/**` | ä¾èµ–ç›®å½• |
| `.DS_Store` | macOS ç³»ç»Ÿæ–‡ä»¶ |
| `Thumbs.db` | Windows ç³»ç»Ÿæ–‡ä»¶ |
| `*.log` | æ—¥å¿—æ–‡ä»¶ |
| `credentials*` | å‡­è¯æ–‡ä»¶ |
| `*.key` | å¯†é’¥æ–‡ä»¶ |
| `*.pem` | è¯ä¹¦æ–‡ä»¶ |
| `.claude/` | Claude é…ç½®ç›®å½•ï¼ˆé™¤ linear-tasksï¼‰ |

### å¤„ç†æ–¹å¼

- è¿™äº›æ–‡ä»¶ä¼šæ˜¾ç¤ºåœ¨ "å»ºè®®å¿½ç•¥" åˆ—è¡¨ä¸­
- ä¸ä¼šè‡ªåŠ¨ç¼–å·ï¼Œç”¨æˆ·éœ€è¦æ˜ç¡®é€‰æ‹©æ‰èƒ½æäº¤
- å¦‚æœç”¨æˆ·å¼ºåˆ¶è¦æäº¤æ•æ„Ÿæ–‡ä»¶ï¼Œæ˜¾ç¤ºè­¦å‘Šç¡®è®¤

## Error Handling

### ä¸åœ¨ Linear åˆ†æ”¯ä¸Š

```
âŒ å½“å‰ä¸åœ¨ Linear åˆ†æ”¯ä¸Š

å½“å‰åˆ†æ”¯: main

è¯·å…ˆä½¿ç”¨ /yux-linear-start åˆ›å»ºä»»åŠ¡åˆ†æ”¯ã€‚
```

### æ²¡æœ‰æœ¬åœ°çŠ¶æ€æ–‡ä»¶

```
âš ï¸ æ²¡æœ‰æ‰¾åˆ°æœ¬åœ°çŠ¶æ€æ–‡ä»¶

è¯·è¿è¡Œ /yux-linear-status åŒæ­¥çŠ¶æ€åå†æäº¤ã€‚
```

### æ²¡æœ‰å˜æ›´

```
â„¹ï¸ æ²¡æœ‰éœ€è¦æäº¤çš„å˜æ›´

å·¥ä½œåŒºæ˜¯å¹²å‡€çš„ã€‚
```

### æäº¤å¤±è´¥

```
âŒ æäº¤å¤±è´¥

é”™è¯¯: <git error message>

è¯·æ£€æŸ¥é—®é¢˜åé‡è¯•ã€‚
```

### Linear åŒæ­¥å¤±è´¥

```
âš ï¸ Linear åŒæ­¥å¤±è´¥

æäº¤å·²å®Œæˆ (abc1234)ï¼Œä½†æ— æ³•åŒæ­¥åˆ° Linearã€‚
é”™è¯¯: <error message>

è¯·æ‰‹åŠ¨åœ¨ Linear ä¸Šè®°å½•æ­¤æäº¤ã€‚
```

## ç¤ºä¾‹

### ç¤ºä¾‹ 1: æ ‡å‡†æµç¨‹

```
User: /yux-linear-commit å®ç°äº†ç™»å½•è¡¨å•

Claude:
=== å½“å‰å˜æ›´ ===

ğŸ“ æ–°å¢æ–‡ä»¶ (1):
   [1] src/components/LoginForm.tsx

ğŸ“ ä¿®æ”¹æ–‡ä»¶ (2):
   [2] src/App.tsx
   [3] src/routes/index.ts

è¯·é€‰æ‹©è¦æäº¤çš„æ–‡ä»¶ï¼š
1. æäº¤æ‰€æœ‰å˜æ›´ (3 ä¸ªæ–‡ä»¶)
2. é€‰æ‹©ç‰¹å®šæ–‡ä»¶
3. æ’é™¤ç‰¹å®šæ–‡ä»¶
4. å–æ¶ˆ

User: 1

Claude:
âœ“ åŸå­æ€§æ£€æŸ¥é€šè¿‡ (æ‰€æœ‰å˜æ›´å±äºåŒä¸€åŠŸèƒ½æ¨¡å—)

ç”Ÿæˆçš„æäº¤ä¿¡æ¯ï¼š

âœ¨ feat(auth): å¢åŠ ç™»å½•è¡¨å•ç»„ä»¶å’Œè·¯ç”±é›†æˆ

**What (åšäº†ä»€ä¹ˆ)**
- åˆ›å»º `LoginForm.tsx` ç»„ä»¶å®ç°ç”¨æˆ·ç™»å½•ç•Œé¢
- æ›´æ–° `App.tsx` é›†æˆç™»å½•ç»„ä»¶
- æ›´æ–° `routes/index.ts` æ·»åŠ ç™»å½•è·¯ç”±

**Why (ä¸ºä»€ä¹ˆåš)**
ä¸ºç”¨æˆ·æä¾›ç™»å½•å…¥å£ï¼Œå®ç°åŸºç¡€è®¤è¯æµç¨‹ã€‚

Refs: LIN-456

**Who (è°åšçš„)**
Co-Authored-By: wuyuxiang ğŸ¤– Generated by Claude AI

ç¡®è®¤ï¼Ÿ(y/ä¿®æ”¹/n)

User: y

Claude:
âœ“ å·²æäº¤ 3 ä¸ªæ–‡ä»¶
âœ“ å·²åŒæ­¥åˆ° Linear: LIN-456

=== æäº¤å®Œæˆ ===

æäº¤å“ˆå¸Œ: a1b2c3d
Linear:   LIN-456 âœ“

ä¸‹ä¸€æ­¥ï¼š
- ç»§ç»­å¼€å‘
- /yux-linear-commit å†æ¬¡æäº¤
- /yux-linear-pr åˆ›å»º PR
- git push (æ‰‹åŠ¨æ¨é€)
```

### ç¤ºä¾‹ 2: é€‰æ‹©æ€§æäº¤

```
User: /yux-linear-commit

Claude:
=== å½“å‰å˜æ›´ ===

ğŸ“ æ–°å¢æ–‡ä»¶ (1):
   [1] src/utils/auth.ts

ğŸ“ ä¿®æ”¹æ–‡ä»¶ (3):
   [2] src/App.tsx
   [3] package.json
   [4] package-lock.json

è¯·é€‰æ‹©è¦æäº¤çš„æ–‡ä»¶ï¼š
...

User: 1,2

Claude:
âœ“ åŸå­æ€§æ£€æŸ¥é€šè¿‡

ç”Ÿæˆçš„æäº¤ä¿¡æ¯ï¼š

âœ¨ feat(auth): å¢åŠ è®¤è¯å·¥å…·æ¨¡å—

**What (åšäº†ä»€ä¹ˆ)**
- åˆ›å»º `auth.ts` è®¤è¯å·¥å…·ç±»
- æ›´æ–° `App.tsx` é›†æˆè®¤è¯æ¨¡å—

**Why (ä¸ºä»€ä¹ˆåš)**
æä¾›ç»Ÿä¸€çš„è®¤è¯é€»è¾‘å¤„ç†ã€‚

Refs: LIN-456

**Who (è°åšçš„)**
Co-Authored-By: wuyuxiang ğŸ¤– Generated by Claude AI

ç¡®è®¤ï¼Ÿ(y/ä¿®æ”¹/n)

User: y

Claude:
âœ“ å·²æäº¤ 2 ä¸ªæ–‡ä»¶
âœ“ å·²åŒæ­¥åˆ° Linear: LIN-456
...
```

### ç¤ºä¾‹ 3: ä¿®æ”¹æäº¤ä¿¡æ¯

```
User: /yux-linear-commit

Claude:
...

ç”Ÿæˆçš„æäº¤ä¿¡æ¯ï¼š

âœ¨ feat(auth): å¢åŠ ç™»å½•éªŒè¯

**What (åšäº†ä»€ä¹ˆ)**
- æ·»åŠ ç™»å½•éªŒè¯é€»è¾‘

**Why (ä¸ºä»€ä¹ˆåš)**
ç¡®ä¿ç”¨æˆ·è¾“å…¥æœ‰æ•ˆã€‚

Refs: LIN-456

**Who (è°åšçš„)**
Co-Authored-By: wuyuxiang ğŸ¤– Generated by Claude AI

ç¡®è®¤ï¼Ÿ(y/ä¿®æ”¹/n)

User: æ”¹æˆ fix ç±»å‹ï¼Œä¿®å¤äº†éªŒè¯é€»è¾‘

Claude:
ä¿®æ”¹åçš„æäº¤ä¿¡æ¯ï¼š

ğŸ› fix(auth): ä¿®å¤ç™»å½•éªŒè¯é€»è¾‘

**What (åšäº†ä»€ä¹ˆ)**
- ä¿®å¤ç™»å½•éªŒè¯é€»è¾‘ä¸­çš„è¾¹ç•Œæ¡ä»¶

**Why (ä¸ºä»€ä¹ˆåš)**
è§£å†³ç”¨æˆ·æ— æ³•æ­£å¸¸ç™»å½•çš„é—®é¢˜ã€‚

Refs: LIN-456

**Who (è°åšçš„)**
Co-Authored-By: wuyuxiang ğŸ¤– Generated by Claude AI

ç¡®è®¤ï¼Ÿ(y/ä¿®æ”¹/n)

User: y

Claude:
âœ“ å·²æäº¤ 2 ä¸ªæ–‡ä»¶
...
```
